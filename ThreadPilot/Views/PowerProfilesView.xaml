<UserControl x:Class="ThreadPilot.Views.PowerProfilesView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             xmlns:local="clr-namespace:ThreadPilot.Views"
             xmlns:vm="clr-namespace:ThreadPilot.ViewModels"
             mc:Ignorable="d" 
             d:DesignHeight="650" d:DesignWidth="800">
    
    <Grid Margin="20">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
            <RowDefinition Height="Auto" />
        </Grid.RowDefinitions>
        
        <!-- Header -->
        <TextBlock Grid.Row="0" Text="Power Profiles" Style="{StaticResource HeaderTextStyle}" />
        
        <!-- Search and Actions Toolbar -->
        <Grid Grid.Row="1" Margin="0,10,0,20">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*" />
                <ColumnDefinition Width="Auto" />
                <ColumnDefinition Width="Auto" />
                <ColumnDefinition Width="Auto" />
                <ColumnDefinition Width="Auto" />
            </Grid.ColumnDefinitions>
            
            <!-- Search Box -->
            <Border Grid.Column="0" BorderBrush="{StaticResource BorderBrush}" BorderThickness="1" CornerRadius="4" Background="White" Padding="8,4">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition Width="*" />
                    </Grid.ColumnDefinitions>
                    <TextBlock Grid.Column="0" Text="🔍" FontSize="14" Margin="0,0,8,0" VerticalAlignment="Center" />
                    <TextBox Grid.Column="1" Text="{Binding SearchText, UpdateSourceTrigger=PropertyChanged}"
                             BorderThickness="0" Background="Transparent"
                             VerticalAlignment="Center" Width="Auto"
                             VerticalContentAlignment="Center"
                             Padding="0,4" />
                </Grid>
            </Border>
            
            <!-- Toolbar Buttons -->
            <Button Grid.Column="1" Margin="10,0,5,0" Command="{Binding RefreshCommand}" ToolTip="Refresh Profiles">
                <StackPanel Orientation="Horizontal">
                    <Path Width="16" Height="16" Stretch="Uniform" Fill="{StaticResource PrimaryBrush}" Data="{StaticResource RefreshIcon}" />
                    <TextBlock Text="Refresh" Margin="5,0,0,0" />
                </StackPanel>
            </Button>
            
            <Button Grid.Column="2" Margin="5,0" Command="{Binding ImportProfileCommand}" ToolTip="Import Profile">
                <StackPanel Orientation="Horizontal">
                    <Path Width="16" Height="16" Stretch="Uniform" Fill="{StaticResource PrimaryBrush}" Data="{StaticResource ImportIcon}" />
                    <TextBlock Text="Import" Margin="5,0,0,0" />
                </StackPanel>
            </Button>
            
            <Button Grid.Column="3" Margin="5,0" Command="{Binding ExportProfileCommand}" ToolTip="Export Selected Profile">
                <StackPanel Orientation="Horizontal">
                    <Path Width="16" Height="16" Stretch="Uniform" Fill="{StaticResource PrimaryBrush}" Data="{StaticResource ExportIcon}" />
                    <TextBlock Text="Export" Margin="5,0,0,0" />
                </StackPanel>
            </Button>
            
            <Button Grid.Column="4" Margin="5,0,0,0" Command="{Binding DeleteProfileCommand}" ToolTip="Delete Selected Profile">
                <StackPanel Orientation="Horizontal">
                    <Path Width="16" Height="16" Stretch="Uniform" Fill="{StaticResource AccentBrush}" Data="{StaticResource DeleteIcon}" />
                    <TextBlock Text="Delete" Margin="5,0,0,0" />
                </StackPanel>
            </Button>
        </Grid>
        
        <!-- Profiles Section -->
        <Grid Grid.Row="2">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="3*" />
                <ColumnDefinition Width="4*" />
            </Grid.ColumnDefinitions>
            
            <!-- Profiles List -->
            <Border Grid.Column="0" Style="{StaticResource CardPanelStyle}" Margin="0,0,10,0">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="*" />
                    </Grid.RowDefinitions>
                    
                    <TextBlock Grid.Row="0" Text="Available Profiles" Style="{StaticResource SubheaderTextStyle}" Margin="0,0,0,10" />
                    
                    <ListView Grid.Row="1" ItemsSource="{Binding FilteredProfiles}" 
                              SelectedItem="{Binding SelectedProfile}" BorderThickness="0"
                              ScrollViewer.VerticalScrollBarVisibility="Auto"
                              ScrollViewer.HorizontalScrollBarVisibility="Disabled">
                        <ListView.ItemContainerStyle>
                            <Style TargetType="ListViewItem" BasedOn="{StaticResource ProcessListItemStyle}" />
                        </ListView.ItemContainerStyle>
                        <ListView.ItemTemplate>
                            <DataTemplate>
                                <Grid Margin="0,5">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto" />
                                        <ColumnDefinition Width="*" />
                                    </Grid.ColumnDefinitions>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto" />
                                        <RowDefinition Height="Auto" />
                                    </Grid.RowDefinitions>
                                    
                                    <!-- Profile icon -->
                                    <Border Grid.Row="0" Grid.RowSpan="2" Grid.Column="0" Width="40" Height="40" 
                                            Background="{StaticResource PrimaryLightBrush}" CornerRadius="20" Margin="0,0,10,0">
                                        <Path Width="20" Height="20" Stretch="Uniform" Fill="White" 
                                              Data="{StaticResource WindowsProfileIcon}"
                                              HorizontalAlignment="Center" VerticalAlignment="Center" />
                                    </Border>
                                    
                                    <!-- Active indicator -->
                                    <Border Grid.Row="0" Grid.RowSpan="2" Grid.Column="0" Width="12" Height="12" 
                                            Background="{StaticResource AccentBrush}" CornerRadius="6" 
                                            HorizontalAlignment="Right" VerticalAlignment="Top" Margin="0,0,5,0"
                                            Visibility="{Binding IsActive, Converter={StaticResource BooleanToVisibilityConverter}}">
                                        <Path Width="8" Height="8" Stretch="Uniform" Fill="White" 
                                              Data="M4,10L2,8L1,9L4,12L9,7L8,6Z"
                                              HorizontalAlignment="Center" VerticalAlignment="Center" />
                                    </Border>
                                    
                                    <!-- Profile name and description -->
                                    <TextBlock Grid.Row="0" Grid.Column="1" Text="{Binding Name}" FontWeight="SemiBold" />
                                    <TextBlock Grid.Row="1" Grid.Column="1" Text="{Binding Description}" 
                                               TextWrapping="Wrap" Opacity="0.7" FontSize="12" />
                                </Grid>
                            </DataTemplate>
                        </ListView.ItemTemplate>
                    </ListView>
                    
                    <!-- Loading indicator -->
                    <Grid Grid.Row="1" Background="#80FFFFFF" 
                          Visibility="{Binding IsLoading, Converter={StaticResource BooleanToVisibilityConverter}}">
                        <StackPanel HorizontalAlignment="Center" VerticalAlignment="Center">
                            <TextBlock Text="Loading profiles..." HorizontalAlignment="Center" />
                            <ProgressBar IsIndeterminate="True" Width="150" Height="4" Margin="0,10,0,0" />
                        </StackPanel>
                    </Grid>
                </Grid>
            </Border>
            
            <!-- Profile Details -->
            <Border Grid.Column="1" Style="{StaticResource CardPanelStyle}" Margin="10,0,0,0">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="*" />
                        <RowDefinition Height="Auto" />
                    </Grid.RowDefinitions>
                    
                    <TextBlock Grid.Row="0" Text="Profile Details" Style="{StaticResource SubheaderTextStyle}" Margin="0,0,0,10" />
                    
                    <!-- No selection message -->
                    <TextBlock Grid.Row="1" Text="Select a power profile to view details" 
                               HorizontalAlignment="Center" VerticalAlignment="Center" Opacity="0.7"
                               Visibility="{Binding SelectedProfile, Converter={StaticResource NullToVisibilityConverter}, ConverterParameter=inverse}" />
                    
                    <!-- Profile details -->
                    <StackPanel Grid.Row="1" Visibility="{Binding SelectedProfile, Converter={StaticResource NullToVisibilityConverter}}">
                        <!-- Profile header -->
                        <Grid Margin="0,0,0,20">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto" />
                                <ColumnDefinition Width="*" />
                            </Grid.ColumnDefinitions>
                            
                            <Border Grid.Column="0" Width="64" Height="64" Background="{StaticResource PrimaryBrush}" 
                                    CornerRadius="32" Margin="0,0,15,0">
                                <Path Width="32" Height="32" Stretch="Uniform" Fill="White" 
                                      Data="{StaticResource WindowsProfileIcon}"
                                      HorizontalAlignment="Center" VerticalAlignment="Center" />
                            </Border>
                            
                            <StackPanel Grid.Column="1">
                                <StackPanel Orientation="Horizontal" Margin="0,0,0,5">
                                    <TextBlock Text="{Binding SelectedProfile.Name}" FontSize="18" FontWeight="SemiBold" />
                                    <Border Background="{StaticResource AccentBrush}" CornerRadius="10" Padding="5,1" Margin="10,0,0,0"
                                            Visibility="{Binding SelectedProfile.IsActive, Converter={StaticResource BooleanToVisibilityConverter}}">
                                        <TextBlock Text="Active" Foreground="White" FontSize="12" FontWeight="SemiBold" />
                                    </Border>
                                </StackPanel>
                                <TextBlock Text="{Binding SelectedProfile.Description}" TextWrapping="Wrap" Opacity="0.8" />
                                <TextBlock Text="{Binding SelectedProfile.Tags}" Opacity="0.7" FontSize="12" Margin="0,5,0,0" />
                            </StackPanel>
                        </Grid>
                        
                        <!-- Profile details -->
                        <Grid Margin="0,0,0,10">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="120" />
                                <ColumnDefinition Width="*" />
                            </Grid.ColumnDefinitions>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                            </Grid.RowDefinitions>
                            
                            <TextBlock Grid.Row="0" Grid.Column="0" Text="Type:" Margin="0,5" FontWeight="SemiBold" />
                            <TextBlock Grid.Row="0" Grid.Column="1" Text="{Binding SelectedProfile.IsBuiltIn, Converter={StaticResource BooleanToBuiltInConverter}}" Margin="0,5" />
                            
                            <TextBlock Grid.Row="1" Grid.Column="0" Text="Date Added:" Margin="0,5" FontWeight="SemiBold" />
                            <TextBlock Grid.Row="1" Grid.Column="1" Text="{Binding SelectedProfile.DateCreated, StringFormat={}{0:MM/dd/yyyy hh:mm tt}}" Margin="0,5" />
                            
                            <TextBlock Grid.Row="2" Grid.Column="0" Text="File Location:" Margin="0,5" FontWeight="SemiBold" 
                                      Visibility="{Binding SelectedProfile.FilePath, Converter={StaticResource EmptyStringToVisibilityConverter}}"/>
                            <TextBlock Grid.Row="2" Grid.Column="1" Text="{Binding SelectedProfile.FilePath}" Margin="0,5" TextWrapping="Wrap"
                                      Visibility="{Binding SelectedProfile.FilePath, Converter={StaticResource EmptyStringToVisibilityConverter}}"/>
                            
                            <TextBlock Grid.Row="3" Grid.Column="0" Text="GUID:" Margin="0,5" FontWeight="SemiBold"
                                      Visibility="{Binding SelectedProfile.Guid, Converter={StaticResource EmptyStringToVisibilityConverter}}"/>
                            <TextBlock Grid.Row="3" Grid.Column="1" Text="{Binding SelectedProfile.Guid}" Margin="0,5" TextWrapping="Wrap"
                                      Visibility="{Binding SelectedProfile.Guid, Converter={StaticResource EmptyStringToVisibilityConverter}}"/>
                        </Grid>
                        
                        <!-- Profile effects description -->
                        <StackPanel Margin="0,20,0,0">
                            <TextBlock Text="What This Profile Does" FontWeight="SemiBold" Margin="0,0,0,10" />
                            <TextBlock Text="Power profiles control how your system manages power consumption and performance. This includes settings like CPU performance states, display brightness, sleep timers, and more."
                                      TextWrapping="Wrap" Margin="0,0,0,10" />
                            
                            <TextBlock Text="Typical Effects:" FontWeight="SemiBold" Margin="0,10,0,5" />
                            <StackPanel Margin="10,0,0,0">
                                <TextBlock Text="• CPU performance and power states management" TextWrapping="Wrap" Margin="0,2" />
                                <TextBlock Text="• Power settings for PCI Express and USB connections" TextWrapping="Wrap" Margin="0,2" />
                                <TextBlock Text="• Sleep and display timeouts" TextWrapping="Wrap" Margin="0,2" />
                                <TextBlock Text="• Hard disk and devices power management" TextWrapping="Wrap" Margin="0,2" />
                            </StackPanel>
                        </StackPanel>
                    </StackPanel>
                    
                    <!-- Action button -->
                    <Button Grid.Row="2" Content="Activate Profile" Command="{Binding ActivateProfileCommand}" 
                            HorizontalAlignment="Left" Margin="0,15,0,0" MinWidth="120"
                            Visibility="{Binding SelectedProfile, Converter={StaticResource NullToVisibilityConverter}}"/>
                </Grid>
            </Border>
        </Grid>
        
        <!-- Description footer -->
        <TextBlock Grid.Row="3" Text="Note: Changing power profiles requires administrative privileges." 
                   Style="{StaticResource BodyTextStyle}" Margin="0,15,0,0" />
    </Grid>
</UserControl>